# Contributing

Thank you for your interest in contributing to Docs Unlocked! This guide covers everything you need to get started.

## Prerequisites

- Node.js 18+ and npm
- Git
- [CumulusCI](https://cumulusci.readthedocs.io/en/latest/tutorial.html) for deployment
- A Salesforce org for testing (recommended)
- Familiarity with React, TypeScript, and Salesforce development

## Setup

1. Fork and clone the repository:

   ```bash
   git clone https://github.com/yourusername/Docs-Unlocked.git
   cd Docs-Unlocked
   git remote add upstream https://github.com/Nimba-Solutions/Docs-Unlocked.git
   ```

2. Install dependencies and create a feature branch:

   ```bash
   npm install
   git checkout -b feature/your-feature-name
   ```

3. Generate a dev org:

   ```bash
   cci flow run dev_org --org dev
   ```

## Development Workflow

### Building for Salesforce

> [!IMPORTANT]
> Only necessary after modifying the React app in `src/`.

```bash
# Default — navigation derived from content directories
npm run build:sf

# With manifest — navigation derived from manifest.yaml
npm run build:sf-manifest
```

Both commands compile TypeScript, bundle the React app with Vite, inline CSS into the JS bundle, copy the bundle to the StaticResource location, and package content into `docsContent.zip`. The default build also generates `manifest.yaml`.

### Deploying and Testing

```bash
# Deploy to your dev org
cci task run deploy --path force-app --org dev

# Run Apex tests
cci task run run_tests --org dev
```

## Submitting Changes

### Reporting Issues

[Open an issue](https://github.com/Nimba-Solutions/Docs-Unlocked/issues/new) with a clear description, steps to reproduce (for bugs), expected vs. actual behavior, and any relevant browser/OS/Salesforce org details or screenshots.

### Pull Request Process

1. **Sync with upstream** before starting work:

   ```bash
   git fetch upstream
   git checkout main
   git merge upstream/main
   git checkout -b feature/your-feature-name
   ```

2. **Make and test your changes:**
   - Run Apex tests (`cci task run run_tests --org dev`)
   - Test across browsers for UI changes
   - Verify both automatic and manual navigation modes

3. **Update documentation** if you're introducing new features or changing processes.

4. **Commit using [conventional commits](https://www.conventionalcommits.org/):**

   ```bash
   git commit -m "feat: description of what you added"
   ```

   Prefixes: `feat:`, `fix:`, `docs:`, `refactor:`, `test:`

5. **Push and open a PR:**

   ```bash
   git push origin feature/your-feature-name
   ```

   Then open a pull request on the [main repository](https://github.com/Nimba-Solutions/Docs-Unlocked). Maintainers will review your code, provide feedback, and merge once approved.

## Code Style

- **TypeScript** — Use proper types; avoid `any` when possible.
- **React** — Prefer functional components with hooks. Keep components focused and single-purpose.
- **Styling** — Use Tailwind CSS classes; avoid inline styles.
- **Accessibility** — Ensure keyboard navigation and include ARIA labels.
- **Documentation** — Add JSDoc comments for functions and complex logic.
- **Error handling** — Provide helpful messages and degrade gracefully.
- **Apex** — Follow Salesforce best practices and maintain >75% test coverage.

## Troubleshooting

**Content not loading?**
Check that the StaticResource name matches your configuration, the ZIP structure is correct (`content/` and `media/` at root), and cache control is set to **Public**. Look at the browser console for path resolution errors.

**Navigation not appearing?**
In manual mode, verify `manifest.yaml` exists with valid YAML syntax. In automatic mode, confirm the `StaticResourceTree` Apex class is deployed. Ensure file paths and numeric prefixes are correct.

**Build failing?**
Run `npm install` to update dependencies, check for TypeScript errors with `npm run build`, and verify you're on Node.js 18+.

**Tests failing?**
Make sure the `docsContent` StaticResource exists in your org and that the Apex class is deployed before running tests.

**Styling issues?**
Confirm Tailwind CSS is configured correctly and that CSS is properly inlined in the bundle. Test across browsers and watch for conflicts with Salesforce's built-in styles.

## Debugging Tips

- **Frontend:** Use browser DevTools and look for console messages prefixed with `[DocsUnlocked]`. Inspect the StaticResource ZIP to verify content packaging.
- **Apex:** Check Salesforce debug logs, use `System.debug()`, and verify test coverage.
- **Content:** Verify the ZIP structure and ensure `manifest.yaml` (if used) matches the actual file paths.

## Questions?

Check existing [issues](https://github.com/Nimba-Solutions/Docs-Unlocked/issues) and [pull requests](https://github.com/Nimba-Solutions/Docs-Unlocked/pulls), or [open a new issue](https://github.com/Nimba-Solutions/Docs-Unlocked/issues/new) to start a discussion.

> [!TIP]
> Start small — even fixing typos or improving docs is valuable. For larger features, consider opening an issue first to align with the project's direction and avoid duplicate effort.
